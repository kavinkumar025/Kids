{
  "version": 3,
  "sources": ["src/app/pages/kid-learning.ts"],
  "sourcesContent": ["import { Component, inject, signal, OnInit, computed } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { KidLayoutComponent } from '../layouts/kid-layout';\nimport { AuthService } from '../services/auth.service';\nimport { FirestoreService } from '../services/firestore.service';\nimport { STORIES, KID_THEMES } from '../constants/app-data';\n\n@Component({\n  selector: 'app-kid-learning',\n  standalone: true,\n  imports: [CommonModule, KidLayoutComponent],\n  template: `\n    <app-kid-layout>\n      <div class=\"animate-fade-in\">\n        <h1 class=\"text-2xl font-bold font-heading tracking-tight mb-2\" data-testid=\"kid-learning-heading\">Stories</h1>\n        <p class=\"text-sm mb-6\" style=\"color: var(--fg-muted)\">Learn about money through fun stories!</p>\n\n        <div class=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n          @for (story of stories; track story.id) {\n            <div class=\"card p-6 cursor-pointer transition-all hover:scale-[1.02]\" (click)=\"openStory(story)\" [attr.data-testid]=\"'kid-story-' + story.id\">\n              <div class=\"flex items-center justify-between mb-2\">\n                <h3 class=\"font-semibold font-heading text-sm\">{{ story.title }}</h3>\n                @if (isCompleted(story.id)) {\n                  <span class=\"badge text-[10px]\" style=\"background-color: #34D39920; color: #34D399\">Done</span>\n                } @else {\n                  <span class=\"badge text-[10px]\" [style.background-color]=\"theme().primary + '15'\" [style.color]=\"theme().primary\">+{{ story.reward_xp }} XP</span>\n                }\n              </div>\n              <p class=\"text-xs\" style=\"color: var(--fg-muted)\">{{ story.description }}</p>\n            </div>\n          }\n        </div>\n\n        @if (selectedStory(); as story) {\n          <div class=\"fixed inset-0 z-50 flex items-center justify-center p-4\" (click)=\"selectedStory.set(null)\">\n            <div class=\"absolute inset-0 bg-black/50\"></div>\n            <div class=\"card p-8 w-full max-w-lg relative z-10 max-h-[90vh] overflow-y-auto animate-fade-in\" (click)=\"$event.stopPropagation()\">\n              <h2 class=\"text-lg font-bold font-heading mb-4\">{{ story.title }}</h2>\n              <p class=\"text-sm leading-relaxed mb-6\" style=\"color: var(--fg-muted)\">{{ story.content }}</p>\n\n              @if (!quizMode()) {\n                <button (click)=\"quizMode.set(true)\" class=\"btn-primary w-full py-3\" [style.background-color]=\"theme().primary\">Take Quiz!</button>\n              } @else {\n                <div class=\"space-y-4\">\n                  @for (q of story.questions; track $index; let i = $index) {\n                    <div class=\"p-4 rounded-xl\" style=\"background-color: var(--muted)\">\n                      <p class=\"text-sm font-medium mb-2\">{{ i + 1 }}. {{ q.question }}</p>\n                      <div class=\"grid grid-cols-2 gap-2\">\n                        @for (opt of q.options; track $index; let j = $index) {\n                          <button (click)=\"answers[i] = j\"\n                                  class=\"text-xs p-2 rounded-xl border transition-all\"\n                                  [style.background-color]=\"answers[i] === j ? theme().primary : ''\"\n                                  [style.color]=\"answers[i] === j ? 'white' : ''\"\n                                  [style.border-color]=\"answers[i] === j ? theme().primary : 'var(--border)'\">{{ opt }}</button>\n                        }\n                      </div>\n                    </div>\n                  }\n                  <button (click)=\"submitQuiz(story)\" class=\"btn-primary w-full py-3\" [style.background-color]=\"theme().primary\" [disabled]=\"submitting()\">Submit</button>\n                  @if (quizResult() !== null) {\n                    <div class=\"p-4 rounded-xl text-center\" style=\"background-color: var(--muted)\">\n                      <p class=\"text-sm font-bold\">Score: {{ quizResult() }}/{{ story.questions.length }}</p>\n                    </div>\n                  }\n                </div>\n              }\n            </div>\n          </div>\n        }\n      </div>\n    </app-kid-layout>\n  `\n})\nexport class KidLearningPage implements OnInit {\n  auth = inject(AuthService);\n  private fs = inject(FirestoreService);\n  stories = STORIES;\n  completedIds = signal<string[]>([]);\n  selectedStory = signal<any>(null);\n  quizMode = signal(false);\n  submitting = signal(false);\n  quizResult = signal<number | null>(null);\n  answers: Record<number, number> = {};\n  theme = computed(() => KID_THEMES[this.auth.kidSession()?.kid?.ui_theme || 'neutral'] || KID_THEMES['neutral']);\n\n  async ngOnInit() {\n    const kid = this.auth.kidSession()?.kid;\n    if (kid) {\n      const progress = await this.fs.getLearningProgress(kid.id);\n      this.completedIds.set(progress.map(p => p.story_id));\n    }\n  }\n\n  isCompleted(id: string) { return this.completedIds().includes(id); }\n\n  openStory(story: any) {\n    this.selectedStory.set(story);\n    this.quizMode.set(false);\n    this.quizResult.set(null);\n    this.answers = {};\n  }\n\n  async submitQuiz(story: any) {\n    const kid = this.auth.kidSession()?.kid;\n    if (!kid) return;\n    this.submitting.set(true);\n    try {\n      let score = 0;\n      story.questions.forEach((q: any, i: number) => { if (this.answers[i] === q.correct) score++; });\n      await this.fs.completeLesson(kid.id, story.id, score, story.reward_xp);\n      this.quizResult.set(score);\n      this.completedIds.update(ids => [...ids, story.id]);\n    } finally { this.submitting.set(false); }\n  }\n}\n"],
  "mappings": "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",
  "names": []
}
